# ===================================
# CRON SCHEDULER ENVIRONMENT VARIABLES
# ===================================
# Copy this file to .env and update with your values
# For production, use .env.production

# ===================================
# APPLICATION CONFIGURATION
# ===================================
NODE_ENV=development
PORT=3000
API_VERSION=v1

# Base URLs
API_BASE_URL=http://localhost:3000
FRONTEND_URL=http://localhost:3001
SCHEDULER_BASE_URL=http://localhost:3000/api/v1/cron

# ===================================
# DATABASE CONFIGURATION (MongoDB)
# ===================================
MONGODB_URI=mongodb://localhost:27017/pipeshub
MONGODB_MAX_POOL_SIZE=10
MONGODB_MIN_POOL_SIZE=2
MONGODB_SERVER_SELECTION_TIMEOUT=5000
MONGODB_CONNECT_TIMEOUT=10000
MONGODB_SOCKET_TIMEOUT=45000

# ===================================
# REDIS CONFIGURATION (BullMQ Queue)
# ===================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Redis Sentinel for High Availability (Optional)
# Format: host1:port1,host2:port2,host3:port3
REDIS_SENTINELS=
REDIS_SENTINEL_NAME=mymaster

# Redis Connection Pool
REDIS_KEEP_ALIVE=30000
REDIS_CONNECT_TIMEOUT=10000
REDIS_COMMAND_TIMEOUT=15000

# ===================================
# CRON SCHEDULER SETTINGS
# ===================================
# Queue Configuration
CRON_QUEUE_NAME=cron-jobs
CRON_QUEUE_PREFIX=bull
CRON_CONCURRENCY=5
CRON_MAX_STALLED_COUNT=3
CRON_STALLED_INTERVAL=30000

# Job Retry Configuration
CRON_MAX_RETRIES=3
CRON_RETRY_DELAY=2000
CRON_BACKOFF_MULTIPLIER=2
CRON_MAX_BACKOFF_DELAY=32000

# Default Timezone
DEFAULT_TIMEZONE=UTC

# Execution Settings
CRON_EXECUTION_TIMEOUT=30000
CRON_MAX_RESPONSE_SIZE=52428800
CRON_COMPRESSION_THRESHOLD=1024
CRON_EXECUTION_RETENTION_DAYS=30

# Rate Limiting
CRON_DEFAULT_RATE_LIMIT=60
CRON_RATE_LIMIT_WINDOW=60000

# ===================================
# DEEPAK'S OPENANALYST API
# ===================================
OPENANALYST_BASE_URL=https://api.openanalyst.com:3456
OPENANALYST_AUTH_ENDPOINT=/api/auth/token
OPENANALYST_AGENT_ENDPOINT=/api/agent/run

# API Credentials (Get from Deepak - DO NOT COMMIT REAL VALUES)
OPENANALYST_API_KEY=your-api-key-here
OPENANALYST_USER_ID=your-user-id-here

# Default Model
OPENANALYST_DEFAULT_MODEL=claude-3-5-sonnet-20241022

# ===================================
# SECURITY & AUTHENTICATION
# ===================================
JWT_SECRET=change-this-to-secure-random-string
JWT_EXPIRES_IN=7d
JWT_REFRESH_SECRET=change-this-to-another-secure-random-string
JWT_REFRESH_EXPIRES_IN=30d

# API Key for Internal Services
INTERNAL_API_KEY=change-this-to-secure-api-key

# CORS Settings
CORS_ORIGIN=*
CORS_CREDENTIALS=true

# ===================================
# MONITORING & LOGGING
# ===================================
LOG_LEVEL=info
LOG_FORMAT=json
LOG_DIR=./logs
LOG_MAX_FILES=14d
LOG_MAX_SIZE=20m

# Health Check Settings
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=60000
HEALTH_CHECK_TIMEOUT=5000

# Alert Thresholds
ALERT_QUEUE_SIZE=1000
ALERT_FAILURE_RATE=0.1
ALERT_WORKER_MEMORY=2147483648
ALERT_REDIS_MEMORY=1073741824
ALERT_EXECUTION_TIME=60000

# Metrics Collection
METRICS_ENABLED=true
METRICS_COLLECTION_INTERVAL=300000
METRICS_RETENTION_DAYS=7

# ===================================
# NOTIFICATION SETTINGS (Optional)
# ===================================
# Slack Notifications
SLACK_WEBHOOK_URL=
SLACK_CHANNEL=#cron-alerts
SLACK_USERNAME=CronSchedulerBot

# Email Notifications
SMTP_HOST=
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=
SMTP_PASSWORD=
ALERT_EMAIL_FROM=noreply@openanalyst.com
ALERT_EMAIL_TO=admin@openanalyst.com

# ===================================
# PM2 CONFIGURATION
# ===================================
PM2_INSTANCES=2
PM2_MAX_MEMORY_RESTART=1G
PM2_EXEC_MODE=cluster

# ===================================
# STORAGE CONFIGURATION
# ===================================
# For storing large responses
STORAGE_PROVIDER=local
STORAGE_LOCAL_PATH=./storage/responses

# S3 Configuration (if using S3)
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1
S3_BUCKET_NAME=cron-scheduler-responses

# ===================================
# DEVELOPMENT SETTINGS
# ===================================
# Test Organization and User (Development Only)
TEST_ORG_ID=
TEST_USER_ID=
TEST_PROJECT_ID=

# ===================================
# FEATURE FLAGS
# ===================================
FEATURE_DUPLICATE_DETECTION=true
FEATURE_AUTO_CLEANUP=true
FEATURE_RESPONSE_COMPRESSION=true
FEATURE_RATE_LIMITING=true
FEATURE_WEBHOOK_NOTIFICATIONS=false

# ===================================
# PERFORMANCE TUNING
# ===================================
# Node.js Settings
NODE_OPTIONS=--max-old-space-size=2048
UV_THREADPOOL_SIZE=4

# Database Connection Pool
DB_CONNECTION_POOL_SIZE=10
DB_CONNECTION_TIMEOUT=10000

# ===================================
# DEBUGGING
# ===================================
DEBUG=false
DEBUG_SQL=false
DEBUG_REDIS=false
DEBUG_HTTP=false
VERBOSE_LOGGING=false